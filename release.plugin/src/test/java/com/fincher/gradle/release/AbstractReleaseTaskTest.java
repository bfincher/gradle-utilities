/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package com.fincher.gradle.release;

import java.io.IOException;

import javax.inject.Inject;

import org.eclipse.jgit.api.Git;
import org.eclipse.jgit.lib.Repository;
import org.gradle.api.Project;
import org.gradle.testfixtures.ProjectBuilder;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;

public class AbstractReleaseTaskTest {
	
	@Mock
	private Repository repo;
	
	@Mock
	private Git git;
	
	@BeforeEach
	public void beforeEach() {
		MockitoAnnotations.openMocks(this);
	}
	
	@Test
	public void pluginRegistersATask() {
		// Create a test project and apply the plugin
		Project project = ProjectBuilder.builder().build();

		project.getTasks().register("abstractReleaseTask", TestClass.class);
		project.getTasks().findByName("abstractReleaseTask");
		project.getPlugins().apply("release.prepareRelease");
//
//		// Verify the result
//		assertNotNull(project.getTasks().findByName("greeting"));
	}
	
	abstract static class TestClass extends AbstractReleaseTask {
		
		@Inject
		public TestClass() {
			
		}
		
		@Override
		protected Repository initGitRepo() throws IOException {
			return repo;
		}
		
		@Override
		protected Git initGit(Repository repo) {
			return git;
		}
	}
}
